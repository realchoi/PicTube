# Context
Filename: Task Analysis.md
Created On: 2025-08-21
Created By: AI
Associated Protocol: RIPER-5 + Multidimensional + Agent Protocol

# Task Description
没有打开任何目录时，在右侧区域展示一个醒目的按钮“打开图片/文件夹”。点击后可选择打开文件夹（左侧显示该目录全部图片）或打开单张图片（左侧仅显示该图片）。

# Project Overview
SwiftUI macOS 应用。左侧 `List(imageURLs)` 展示图片缩略图，右侧使用 `ZoomableImageView` 展示选中图片。现有工具栏按钮仅支持“打开文件夹”。

---
# Analysis (Populated by RESEARCH mode)
基于 `ContentView.swift` 现状：列表与选中状态由 `imageURLs` 和 `selectedImageURL` 管理；未选中图片时右侧显示提示文本；仅提供 `openFolder()`。需要新增统一的“打开文件/文件夹”的打开逻辑，并在右侧为空时显示醒目的入口按钮。同时需要本地化新文案键。

# Proposed Solution (Populated by INNOVATE mode)
在详情区域无图片可显示时，呈现一个居中的大按钮，触发 `NSOpenPanel`，允许选择文件或目录：
- 选择目录：遍历加载受支持的图片到 `imageURLs`，默认选中第一张；
- 选择文件：`imageURLs = [fileURL]` 且 `selectedImageURL = fileURL`；
工具栏按钮也统一改为调用此打开逻辑。新增本地化键：`open_file_or_folder_button`。

# Implementation Plan (Generated by PLAN mode)
```
Implementation Checklist:
1. 在 `Languages/zh-Hans.lproj/Localizable.strings` 与 `Languages/en.lproj/Localizable.strings` 添加 `open_file_or_folder_button` 文案。
2. 在 `ContentView.swift` 中新增 `openFileOrFolder()`，允许选择文件或目录，并按选择类型更新 `imageURLs`/`selectedImageURL`。
3. 将工具栏按钮改为使用 `NSLocalizedString("open_file_or_folder_button", ...)` 与 `openFileOrFolder()`。
4. 当 `imageURLs.isEmpty` 时，在详情区域显示大按钮，点击后调用 `openFileOrFolder()`；否则维持现有展示逻辑。
```

# Current Execution Step (Updated by EXECUTE mode when starting a step)
> Currently executing: "All steps completed"

# Task Progress (Appended by EXECUTE mode after each step completion)
*   2025-08-21 00:00
    *   Step: 1. 添加本地化键 `open_file_or_folder_button`
    *   Modifications: 更新 `Languages/zh-Hans.lproj/Localizable.strings` 与 `Languages/en.lproj/Localizable.strings`
    *   Change Summary: 新增“打开图片/文件夹”按钮文案
    *   Reason: 执行计划步骤 1
    *   Blockers: None
    *   User Confirmation Status: Pending
*   2025-08-21 00:00
    *   Step: 2-4. 新增 `openFileOrFolder()`、更新工具栏按钮与详情区域按钮
    *   Modifications: 编辑 `PicTube/ContentView.swift`，新增打开文件/目录逻辑，更新 toolbar 按钮，空状态添加大按钮
    *   Change Summary: 支持选择单文件或目录，并在无图片时提供入口按钮
    *   Reason: 执行计划步骤 2-4
    *   Blockers: None
    *   User Confirmation Status: Pending
# Final Review (Populated by REVIEW mode)

